USE [DATACLASSIC]
GO

/****** Object:  View [dbo].[BM_FATURAMENTOS]    Script Date: 26/02/2024 09:46:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


--USE [DATACLASSIC]
--GO

--/****** Object:  View [dbo].[BM_FATURAMENTOS]    Script Date: 10/10/2022 10:53:53 ******/
--SET ANSI_NULLS ON
--GO

--SET QUOTED_IDENTIFIER ON
--GO





CREATE VIEW [dbo].[BM_FATURAMENTOS] AS
SELECT 
	   TB02021_CODIGO Pedido,
	   TB02021_NTSERV Nota,
	   'SERVIÃ‡OS' Grupo,
	   TB02021_DATA [Data],
	   TB01006_NOME Vendedor,
	   TB02021_VEND CodVend,
	   TB02023_TOTVALOR Valor,
	   CAST(TB02023_TOTVALOR * (TB01005_VLRCOMISSAO * 0.01) as numeric(11,2)) Comissao,
	   TB01007_NOME Empresa,
	   TB01005_NOME Servico,
	   TB01008_NOME Cliente,
	   TB01107_NOME	GrupoEco,
	   TB01019_NOME Nivel
	  
  FROM TB02023
LEFT JOIN TB02021 ON TB02021_CODIGO = TB02023_CODIGO
LEFT JOIN TB01007 ON TB01007_CODIGO = TB02021_CODEMP
LEFT JOIN TB01008 ON TB01008_CODIGO = TB02021_CODCLI
LEFT JOIN TB01005 ON TB01005.TB01005_CODIGO = TB02023_CODSERV
LEFT JOIN TB01006 ON TB01006_CODIGO = TB02021_VEND
LEFT JOIN TB01107 ON TB01107_CODIGO = TB01008_GRUPO
LEFT JOIN TB01019 ON TB01019_CODIGO = TB01008_NIVEL

 
 WHERE TB02021_BONIF = 'N'
   AND TB02021_TIPODESC NOT IN ('19', '29')
GO

